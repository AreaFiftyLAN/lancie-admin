<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-lazy-pages/iron-lazy-pages.html">

<dom-module id="lancie-admin-content">
  <template>
    <style>
      :host {
        display: block;
        height: inherit;
      }

      iron-lazy-pages {
        height: inherit;
      }
    </style>

    <app-location route="{{route}}"></app-location>
    <app-route route="{{route}}" pattern="/:page" data="{{page}}"></app-route>

    <paper-toast id="globalToast"></paper-toast>

    <iron-lazy-pages attr-for-selected="data-route" selected="[[page.page]]" fallback-selection="404">

      <lancie-admin-home data-route="" data-path="lancie-admin-home/lancie-admin-home.html"></lancie-admin-home>

      <lancie-admin-endpoint endpoint="Users" data-route="users" data-path="lancie-admin-endpoint/lancie-admin-endpoint.html"></lancie-admin-endpoint>

      <lancie-admin-endpoint endpoint="Orders" data-route="orders" data-path="lancie-admin-endpoint/lancie-admin-endpoint.html"></lancie-admin-endpoint>

      <lancie-admin-endpoint endpoint="Tickets" data-route="tickets" data-path="lancie-admin-endpoint/lancie-admin-endpoint.html"></lancie-admin-endpoint>

      <lancie-admin-endpoint endpoint="Teams" data-route="teams" data-path="lancie-admin-endpoint/lancie-admin-endpoint.html"></lancie-admin-endpoint>

      <lancie-404 data-route="404" data-path="lancie-admin-404.html"></lancie-404>
    </iron-lazy-pages>

  </template>

  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'lancie-admin-content',
      properties: {
        page: {
          type: Object,
          notify: true
        }
      },

      ready: function () {
        // Catch global toast events
        this.addEventListener('toast', function(e) {
          this.showToast(e.detail);
        }.bind(this));

        // Since the paper-dialogs are put here, the toast has to be moved here. If this is not done, the toasts will appear behind the backdrop.
        window.document.body.appendChild(this.$.globalToast);
      },

      showToast: function(properties) {
        if (this.$.globalToast.opened) {
          this.$.globalToast.close();
          this.async(function() {
            this.$.globalToast.show(properties);
          }, 100);
        } else {
          this.$.globalToast.show(properties);
        }
      },

    });
  })();
  </script>
</dom-module>
